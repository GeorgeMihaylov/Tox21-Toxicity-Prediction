# Прогноз токсичности химических соединений (Tox21)

## Описание проекта
Данный проект направлен на предсказание биологической активности молекул по отношению к андрогеновому рецептору (мишень `NR-AR`). Проект выполнен в рамках курса «ИИ в биотехнологии» и представляет собой полный цикл применения машинного обучения в хемоинформатике.

Цель: классификация молекул на токсичные (активные) и нетоксичные (неактивные) на основе их химической структуры.

## Данные
Использован открытый датасет **Tox21** (Toxicology in the 21st Century), предоставленный в рамках бенчмарка MoleculeNet.
- **Размер данных:** 7,258 валидных молекул.
- **Дисбаланс классов:** ~96% неактивных (класс 0) и ~4% активных (класс 1).
- **Признаки (Features):** Morgan Fingerprints (радиус 2, 2048 бит), сгенерированные из строк SMILES.

## Структура репозитория
- `data/` — скачанные и обработанные данные (CSV).
- `src/` — исходный код проекта.
  - `step1_download_inspect.py` — загрузка данных из MoleculeNet.
  - `step2_clean_data.py` — валидация SMILES через RDKit и удаление дубликатов.
  - `step3_eda.py` — вычисление физико-химических дескрипторов (MW, LogP) и визуализация.
  - `step4_features.py` — генерация молекулярных фингерпринтов.
  - `step5_models.py` — обучение моделей и оценка качества.
- `reports/figures/` — графики EDA и ROC-кривые.

## Стек технологий
- Python 3
- RDKit (хемоинформатика)
- pandas, numpy (обработка данных)
- scikit-learn, xgboost (машинное обучение)
- matplotlib, seaborn (визуализация)

## Результаты и методы борьбы с дисбалансом
Датасет имеет экстремальный дисбаланс: 6956 неактивных и всего 302 активных соединения (менее 5%). Для решения этой проблемы были применены:
1. **Генерация дополнительных признаков**: к 2048 битам Morgan Fingerprints добавлены 6 физико-химических дескрипторов (MW, LogP, TPSA, HBD, HBA, RotBonds).
2. **SMOTEENN** (Synthetic Minority Over-sampling Technique + Edited Nearest Neighbours) — генерация синтетических активных молекул с одновременным удалением "шума" на границах классов.
3. **Threshold Tuning** — динамический подбор порога классификации (Threshold) для максимизации F1-Score.

**Итоговые метрики:**
- **XGBoost (Class Weights)**: ROC-AUC = 0.716, Оптимальный порог = 0.883
- **Random Forest (SMOTEENN)**: ROC-AUC = 0.648, Оптимальный порог = 0.759

Благодаря динамическому подбору порога удалось достичь высокой точности классификации токсичных молекул: **Precision = 0.89** (модель ошибается лишь в 11% случаев при классификации молекулы как токсичной) при **F1-score = 0.54**, что является высоким показателем для данной специфики данных Tox21.
